<!doctype html><html lang="zh-tw">
<head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Java Tutorial 第二堂（1）數值與字串型態&nbsp;&lt;&lt; 前情 
      
      想想你平時撰寫的一些應用程式，大部份是在處理一組資料，Java 對管理資料用的...">

<meta property="og:locale" content="zh_TW">
<meta property="og:title" content="Java Tutorial 第二堂（2）容器與流程語法">
<meta property="og:type" content="article">
<meta property="og:url" content="https://openhome.cc/Gossip/CodeData/JavaTutorial/ContainerFlow.html">
<meta property="og:image" content="https://openhome.cc/Gossip/images/caterpillar_small.jpg">
<meta property="og:site_name" content="OPENHOME.CC">
<meta property="og:description" content="Java Tutorial 第二堂（1）數值與字串型態&nbsp;&lt;&lt; 前情 
      
      想想你平時撰寫的一些應用程式，大部份是在處理一組資料，Java 對管理資料用的...">


    <title>Java Tutorial 第二堂（2）容器與流程語法</title>

<link rel="stylesheet" href="../../css/pure-0.6.0/pure-min.css">

    <!--[if lte IE 8]>
        <link rel="stylesheet" href="../../css/layouts/side-menu-old-ie.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="../../css/layouts/side-menu.css">
    <!--<![endif]-->
  

     <link rel="stylesheet" href="../../css/caterpillar.css">
     <script async src="../../google-code-prettify/run_prettify.js"></script>
<!-- 網頁層級廣告 --><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle =window.adsbygoogle || []).push({google_ad_client: "ca-pub-9750319131714390",enable_page_level_ads: true });</script></head>
<body>

<div id="layout">
    <!-- Menu toggle -->
    <a href="ContainerFlow.html#menu" id="menuLink" class="menu-link">
        <!-- Hamburger icon --><span></span>
        
    </a>
    <div id="menu">
        <div class="pure-menu">
            <a class="pure-menu-heading" href="index.html">回 Java Tutorial</a>
            <ul class="pure-menu-list">
                <br><div class="social" style="text-align: center;"><a href="http://twitter.com/caterpillar"><img title="Twitter" alt="Twitter" src="../../images/twitter.png"></a> <a href="http://www.facebook.com/openhome.cc"><img title="Facebook" alt="Facebook" src="../../images/facebook.png"></a> </div><br><div id="search box"><script>(function() {var cx = 'partner-pub-9750319131714390:3926766884';var gcse = document.createElement('script');gcse.type = 'text/javascript';gcse.async = true;gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//www.google.com/cse/cse.js?cx=' + cx;var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(gcse, s);})();</script><gcse:searchbox-only></gcse:searchbox-only></div><br><div class="ad" style="text-align: center;"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 2015 新版型 160 x 600 廣告 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:160px;height:600px"
     data-ad-client="ca-pub-9750319131714390"
     data-ad-slot="3747048883"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div></li>
            </ul>
        </div>
    </div>

    <main id="main">
        <header class="header">
            <h1>Java Tutorial 第二堂（2）容器與流程語法</h1>
        </header>

        <article class="content"><br><div class="ad-3" style="text-align: center;"><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- 2015 新版型回應式廣告 --><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9750319131714390" data-ad-slot="7104125683" data-ad-format="auto"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div> 
              <br>
      <br>
      想想你平時撰寫的一些應用程式，大部份是在處理一組資料，Java 對管理資料用的容器（Container）型態，在語法上提供直接支援的只有陣列，其餘則是以程式庫的形式存在，除了標準程式庫之外，還有各式開放原始碼程式庫可供選擇。 <br>
      <br>
      在這邊將會介紹 Java 中的陣列、<code>List</code>、<code>Set</code>，在鍵（Key）值（Value）結構的型態上，則介紹 <code>Map</code>。除了標準 API 的容器類別實作之外，還介紹了 guava-libraries 的 Collections 實作。
      <h1>陣列型態</h1>
      Java 目前唯一在語法上提供支援的是陣列，<strong>如果你需要容量固定且有序的容器，就可以使用陣列</strong>。例如 <code>Integer[] numbers = {1, 2, 3};</code>，可以建立容量為 3 的陣列而索引為 0、1、2 的陣列。 <br>
      <br>
      在 Java 中陣列是物件，雖然如此，基本上與陣列有關的屬性只有&nbsp;<code>length</code>，可用來取得陣列的容量。如果你想對陣列做任何其他操作，可以使用 <strong><code>java.util.Arrays</code></strong> 提供的 <code>static</code> 方法。像是使用 <code>fill</code> 於陣列中填充元素、使用 <code>copyOf</code> 來複製陣列等簡單操作，若是需要更多對容器的操作，建議使用其他容器型態。
      <h1>List 型態</h1>
      <strong>如果需要有序具索引特性的容器，且需要比陣列擁有更多功能，可以使用 <code>List</code></strong>，這個型態定義在 <code>java.util</code> 套件中。如果已知有若干元素，可以使用 <code>java.util.Arrays</code> 提供的 <code>static</code> 方法 <code>asList</code> 來建立 <code>List</code> 實作物件。例如：
      <pre class="prettyprint"><code lang="java">List&lt;Integer&gt; numbers = Arrays.asList(1, 2, 3);</code></pre>
      <br>
      如果事先不知道要收集哪些元素，可以直接建立 <code>List</code> 的實作物件，<strong>你完全可以視需求採用適當資料結構實作的物件</strong>，像是內部實作採陣列的 <code>ArrayList</code>、採鏈結的 <code>LinkedList</code> 等標準 API 中定義的物件，甚至是來自開放原始碼的 <code>List</code> 實作物件，像是後續會介紹的 guava-libraries。例如，如果你需要在收集之後，擁有較好的索引存取效率，可以採用 <code>ArrayList</code>。
      <pre class="prettyprint"><code lang="java">List&lt;Integer&gt; numbers = Arrays.asList(1, 2, 3);
List&lt;Integer&gt; collector = new ArrayList&lt;&gt;();
collector.add(10);
collector.addAll(numbers);
collector.size(); // 4</code></pre>
      <br>
      在上面的範例中，由於宣告 <code>collector</code> 時已經指定了 <code>List&lt;Integer&gt;</code>，表示要收集的元素都是 <code>Integer</code>，因此建構實作物件 <code>ArrayList</code> 時，就不用於 <code>&lt;&gt;</code> 中再指定 <code>Integer</code> 型態，<strong>編譯器會自行由 <code>collector</code> 的型態中推斷，<code>ArrayList</code> 中裝載的型態是 <code>Integer</code></strong>，實際上這是 JDK7 之後的新功能，在之前版本，你必須明確地定義為 <code>List&lt;Integer&gt; collector = new ArrayList&lt;Integer&gt;()</code>。
      <h1>Set 型態</h1>
      <strong><code>Set</code> 型態是無序群集（<code>Collection</code>），管理的元素不會重複</strong>，照例地，你可以擁需求選用適當的資料結構實作物件，像是基於雜湊（Hash）的 <code>HashSet</code>，或者是基於紅黑樹實作的 <code>TreeSet</code>。以下是使用 <code>Set</code> 來模彷 <a

        href="../PythonTutorial/ContainerFlowComprehension.html">Python Tutorial 第二堂（2）</a>中 <code>set</code> 的示範：
      <pre class="prettyprint"><code lang="java">import java.util.*;
import static java.lang.System.out;

public class Main {
    public static void main(String[] args) {
        Set&lt;String&gt; admins = new HashSet&lt;&gt;(Arrays.asList("Justin", "caterpillar"));
        Set&lt;String&gt; users = new HashSet&lt;&gt;(Arrays.asList("momor", "hamini", "Justin"));

        out.println(admins.contains("Justin")); // 是否在站長群？true

        Set&lt;String&gt; intersection = new HashSet&lt;&gt;(admins);
        intersection.retainAll(users); // 同時是站長群也是使用者群的？
        out.println(intersection);  // [Justin]

        Set&lt;String&gt; union = new HashSet&lt;&gt;(admins);
        union.addAll(users);  // 是站長群或是使用者群的？
        out.println(union);  // [momor, hamini, Justin, caterpillar]

        Set&lt;String&gt; adminsButNotUsers = new HashSet&lt;&gt;(admins);
        adminsButNotUsers.removeAll(users);  // 站長群但不使用者群的？
        out.println(adminsButNotUsers);  // [caterpillar]

        Set&lt;String&gt; xor = new HashSet&lt;&gt;(union);
        xor.removeAll(intersection);  // xor
        out.println(xor); // [momor, hamini, caterpillar]

        out.println(admins.containsAll(users));  // ∈，false
        out.println(users.containsAll(admins));  // false
    }
}</code></pre>
      <br>
      除了 <code>List</code>、<code>Set</code> 本身定義的操作之外，有些操作可以在 <strong><code>java.util.Collections</code></strong> 的 <code>static</code> 方法找到。
      <h1>Map 型態</h1>
      鍵值對應的物件，在 Java 中可使用 <code>Map</code> 型態，你可以依需求選用適當的資料結構實作，像是 <code>HashMap</code>、<code>TreeMap</code> 等，以下是模彷 <a

        href="../PythonTutorial/ContainerFlowComprehension.html">Python Tutorial 第二堂（2）</a>中 <code>dict</code> 的示範：
      <pre class="prettyprint"><code lang="java">import java.util.*;
import static java.lang.System.out;

public class Main {
    public static void main(String[] args) {
        Map&lt;String, Integer&gt; passwords = new HashMap&lt;&gt;();
        passwords.put("Justin", 123456);
        passwords.put("caterpillar", 93933);

        out.println(passwords.get("Justin")); // 123456

        passwords.put("Hamimi", 970221);  // 增加一對鍵值
        out.println(passwords);  // {Justin=123456, caterpillar=93933, Hamimi=970221}

        passwords.remove("caterpillar");  // 刪除一對鍵值
        out.println(passwords);  // {Justin=123456, Hamimi=970221}

        out.println(passwords.entrySet()); // [Justin=123456, Hamimi=970221]
        out.println(passwords.keySet());   // [Justin, Hamimi]
        out.println(passwords.values());   // [123456, 970221]
    }
}</code></pre>
      <h1>Guava Collections</h1>
      Java 標準 API 的容器物件，著重在功能性的定義與實作，少於考量易用性，加上 Java 本身又是靜態定型（Statically-typed）語言，不少地方都需要型態宣告，因而使用上就現今眼光來說，頗為不便。<strong>Java 的世界中有不少的開放原始碼程式庫，可以補強 Java 在這方面的不足</strong>，在這邊使用一下&nbsp;<a

        href="https://code.google.com/p/guava-libraries/">guava-libraries</a> 的 Collections，讓需求在操作上比較方便一些。 <span

        style="color: #ff0000;"><strong><br>
          <br>
          練習 5：使用 Guava Collections</strong></span> <br>
      <br>
      在這個練習中，將使用 Guava Collections 來改寫先前的一些範例，不過在急著到 Guava 官方網站下載相關 jar 檔案之前，別忘了我們有安裝 Gradle，它可以自動幫你下載 jar 檔案，為此，先在使用者目錄下建立一個 Collections 目錄與 Gradle 慣例的相關子目錄：
      <pre class="prettyprint"><code lang="java">~$ mkdir Collections
~$ cd Collections
~/Collections$ mkdir -p src/main/java
~/Collections$ st2 build.gradle</code></pre>
      <br>
      最後一個指令建立了 build.gradle 檔案，你可以如下撰寫，使用 <code>'java'</code>、<code>'application'</code> 的 plugin，設定 <code>mainClassName</code>，下載 jar 檔案的來源，以及你想要下載的程式庫名稱、版本等。
      <pre class="prettyprint"><code lang="java">apply plugin: 'java'
apply plugin:'application'
mainClassName = "Main"

repositories {
  mavenCentral()
}

dependencies {
  compile group: 'com.google.guava', name: 'guava', version: '15.0'
}</code></pre>
      <br>
      接著編輯 Main.java
      <pre class="prettyprint"><code lang="java">~/Collections$ st2 src/main/java/Main.java</code></pre>
      <br>
      內容如下：
      <pre class="prettyprint"><code lang="java">import java.util.*;
import com.google.common.collect.*;
import static java.lang.System.*;

public class Main {
    public static void main(String[] args) {
        // List Demo
        List&lt;Integer&gt; numbers = Arrays.asList(1, 2, 3);
        List&lt;Integer&gt; collector = 
            ImmutableList.&lt;Integer&gt;builder()
                         .add(10)
                         .addAll(numbers)
                         .build();

        out.println(collector.size()); // 4

        // Set Demo
        Set&lt;String&gt; admins = ImmutableSet.of("Justin", "caterpillar");
        Set&lt;String&gt; users = ImmutableSet.of("momor", "hamini", "Justin");

        // 是否在站長群？true
        out.println(admins.contains("Justin")); 
        // 同時是站長群也是使用者群的？ [Justin]
        out.println(Sets.intersection(admins, users)); 
        // 是站長群或是使用者群的？ [Justin, caterpillar, momor, hamini]
        out.println(Sets.union(admins, users)); 
        // 站長群但不使用者群的？ [caterpillar]
        out.println(Sets.difference(admins, users)); 
        // xor [caterpillar, momor, hamini]
        out.println(Sets.symmetricDifference(admins, users)); 
        // ∈，false
        out.println(admins.containsAll(users));  
        // false
        out.println(users.containsAll(admins));  

        // Map Demo
        Map&lt;String, Integer&gt; passwords = <br>            ImmutableMap.of("Justin", 123456, "caterpillar", 93933);

        out.println(passwords.get("Justin")); // 123456
        out.println(passwords.entrySet()); // [Justin=123456, Hamimi=970221]
        out.println(passwords.keySet());   // [Justin, Hamimi]
        out.println(passwords.values());   // [123456, 970221]
    }
}</code></pre>
      <br>
      比較一下與先前範例的差別，看看有沒有比較方便與清楚一些，然後執行 <code>gradle run</code>：
      <pre class="prettyprint"><code lang="java">~/Collections$ gradle run</code></pre>
      <br>
      第一次執行時，Gradle 會自動下載 jar 檔案，然後進行編譯與執行，你應該看到以下結果：
      <pre class="prettyprint"><code lang="java">4
true
[Justin]
[Justin, caterpillar, momor, hamini]
[caterpillar]
[caterpillar, momor, hamini]
false
false
123456
[Justin=123456, caterpillar=93933]
[Justin, caterpillar]
[123456, 93933]</code></pre>
      <br>
      如果想要瞭解更多有關 Guava Collections 或更多 guava-libraries 的介紹，可以參考本站的 <a href="http://www.codedata.com.tw/forum/viewthread.php?tid=116&amp;extra=page%3D1">Guava 教學</a>。
      <h1>if、switch、while 與 for</h1>
      流程語法中最簡單的 <code>if..else</code> 分支判斷，在 Java 中是這樣寫的：
      <pre class="prettyprint"><code lang="java">if(args.length &gt; 1) {
    out.println("Hello, " + args[0]);
} else {
    out.println("Hello, Guest");
}</code></pre>
      <br>
      Java 中的 <code>if..else</code> 是陳述（Statement），有個類似運算式（Expression）形式是三元運算子 <code>?:</code>。<code>?</code> 前的條件式成立的話，會傳回 <code>:</code> 左邊的值，否則傳回 <code>:</code> 右邊的值。例如上面的程式也可以寫為：
      <pre class="prettyprint"><code lang="java">out.printf("Hello, %s%n", args.length &gt; 1 ? args[0] : "Guest")</code></pre>
      <br>
      如果想要比對的是某些值，在 Java 中可以使用 <code>switch</code>，它可以用在整數、字串、字元等的比對。例如在 <a

        href="NumberString.html">Java Tutorial 第二堂（1）</a>中就看過字串的比對：
      <pre class="prettyprint"><code lang="java">    ...
        switch(args[1]) {
            case "+": out.println(x.add(y)); break;
            case "-": out.println(x.subtract(y)); break;
            case "x": out.println(x.multiply(y)); break;
            case "/": out.println(x.divide(y));
        }
    ...</code></pre>
      <code><br>
        while</code> 迴圈可以使用在結束條件不確定的情況下。例如求最大公因數可以如下：
      <pre class="prettyprint"><code lang="java">public class GCD {
    public static void main(String[] args) {
        int m = Integer.parseInt(args[0]);
        int n = Integer.parseInt(args[1]);
        while(n != 0) {
            int r = m % n;
            m = n;
            n = r;
        }
        System.out.printf("GCD: %d%n", m);
    }
}</code></pre>
      <code><br>
        for</code> 通常用來進行索引相關的迴圈，例如指定索引迭代命令列引數：
      <pre class="prettyprint"><code lang="java">for(int i = 0; i &lt; args.length; i++) {
    out.println(args[i]);
}</code></pre>
      <br>
      從頭至尾循序存取是很常見的需求，這邊介紹到的陣列、<code>List</code>、<code>Set</code> 等，其實都可以使用 foreach 語法，將元素從頭至尾循序迭代：
      <pre class="prettyprint"><code lang="java">for(String arg : args) {
    out.println(arg);
}</code></pre>
      <br>
      實際上，只要是具備 <strong><code>java.lang.Iterable</code></strong> 行為的物件，都可以搭配 foreach 語法，像是 <a

        href="Package-IO-Exception.html">Java Tutorial 第一堂（4）</a>中使用到的 <code>Path</code> 實例，就可以搭配 foreach 來迭代路徑資訊。 <strong><span

          style="color: #ff0000;"><br>
          <br>
          練習 6：使用 foreach 迭代路徑</span></strong> <strong><br>
        <br>
        在 Java 中，可以查看 API 文件，確認物件是否擁有某些行為。</strong>舉例來說，想瞭解 <code>List</code> 是否為一種 <code>Iterable</code>，可以查看 <a

        href="http://docs.oracle.com/javase/7/docs/api/java/util/List.html"><code>List</code> 的 API 文件</a>： <br>
      <br>
      <a href="images/java-tutorial-the-2nd-class-2-container-flow-1.png"><img

          class="alignnone size-full wp-image-3209" alt="java-tutorial-the-2nd-class-2-container-flow-1"

          src="images/java-tutorial-the-2nd-class-2-container-flow-1.png"

          height="282" width="649"></a> <br>
      <br>
      在 All Superinterfaces 上，可以看到 <code>Iterable</code>，這表示 <code>List</code> 也是一種 <code>Iterable</code>。如果想知道總共有哪些物件具有 <code>Iterable</code> 的行為，則可以查看 <a

        href="http://docs.oracle.com/javase/7/docs/api/java/lang/Iterable.html"><code>Iterable</code> 的 API 文件</a>，看看它的 All Know Implementing Classes 有哪些。 <br>
      <br>
      類似地，查看一下 <code>Path</code> 的 API 文件，可以發現它也是一種 <code>Iterable</code>，因此可以撰寫一個程式如下：
      <pre class="prettyprint"><code lang="java">import java.nio.file.*;

public class ForEach {
    public static void main(String[] args) {
        for(Path parent : Paths.get(args[0])) {
            System.out.println(parent);
        }
    }
}</code></pre>
      <br>
      這個程式可以接受命令列引數，你可以指定一個目錄，程式將會將每個子路徑顯示出來，你可以使用 <code>javac</code> 編譯、<code>java</code> 來執行，或者是使用至目前為止習得的 Gradle 工具來建構程式並執行。 <br>
      <br><br><br><div class="ad336-280" style="text-align: center;"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- 2015 新版型廣告 336 x 280 --><ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-9750319131714390" data-ad-slot="9976409681"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div><br><div class="recommend" style="text-align: center;"><hr><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- 自動大小回應相符內容 --><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9750319131714390" data-ad-slot="4953478487" data-ad-format="autorelaxed"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></article></main></div></body>
<script src="../../js/ui.js"></script>
</html>
<div class="analytics"><script async src="https://www.googletagmanager.com/gtag/js?id=G-QVQQYFSC8J"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-QVQQYFSC8J');</script></div>
