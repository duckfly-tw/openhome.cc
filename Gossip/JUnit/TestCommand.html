<!doctype html><html lang="zh-tw">
<head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="簡
單的測試每個人都會寫。例如，現在測試人員撰寫測試案例，你負責提供測試案例的執行器（Test
runner），讓測試人員可以執行測試案例以觀看測試結果。
      
如果測試人員看到某個類...">

<meta property="og:locale" content="zh_TW">
<meta property="og:title" content="你來寫，我來跑">
<meta property="og:type" content="article">
<meta property="og:url" content="https://openhome.cc/Gossip/JUnit/TestCommand.html">
<meta property="og:image" content="https://openhome.cc/Gossip/images/caterpillar_small.jpg">
<meta property="og:site_name" content="OPENHOME.CC">
<meta property="og:description" content="簡
單的測試每個人都會寫。例如，現在測試人員撰寫測試案例，你負責提供測試案例的執行器（Test
runner），讓測試人員可以執行測試案例以觀看測試結果。
      
如果測試人員看到某個類...">


    <title>你來寫，我來跑</title>

<link rel="stylesheet" href="../css/pure-0.6.0/pure-min.css">

    <!--[if lte IE 8]>
        <link rel="stylesheet" href="../css/layouts/side-menu-old-ie.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="../css/layouts/side-menu.css">
    <!--<![endif]-->
  

     <link rel="stylesheet" href="../css/caterpillar.css">
     <script async src="../google-code-prettify/run_prettify.js"></script>
<!-- 網頁層級廣告 --><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle =window.adsbygoogle || []).push({google_ad_client: "ca-pub-9750319131714390",enable_page_level_ads: true });</script></head>
<body>

<div id="layout">
    <!-- Menu toggle -->
    <a href="TestCommand.html#menu" id="menuLink" class="menu-link">
        <!-- Hamburger icon --><span></span>
        
    </a>
    <div id="menu">
        <div class="pure-menu">
            <a class="pure-menu-heading" href="index.html">回 JUnit 目錄</a>
            <ul class="pure-menu-list">
                <br><div class="social" style="text-align: center;"><a href="http://twitter.com/caterpillar"><img title="Twitter" alt="Twitter" src="../images/twitter.png"></a> <a href="http://www.facebook.com/openhome.cc"><img title="Facebook" alt="Facebook" src="../images/facebook.png"></a> </div><br><div id="search box"><script>(function() {var cx = 'partner-pub-9750319131714390:3926766884';var gcse = document.createElement('script');gcse.type = 'text/javascript';gcse.async = true;gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//www.google.com/cse/cse.js?cx=' + cx;var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(gcse, s);})();</script><gcse:searchbox-only></gcse:searchbox-only></div><br><div class="ad" style="text-align: center;"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 2015 新版型 160 x 600 廣告 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:160px;height:600px"
     data-ad-client="ca-pub-9750319131714390"
     data-ad-slot="3747048883"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div></li>
            </ul>
        </div>
    </div>

    <main id="main">
        <header class="header">
            <h1>你來寫，我來跑</h1>
        </header>

        <article class="content"><br><div class="ad-3" style="text-align: center;"><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- 2015 新版型回應式廣告 --><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9750319131714390" data-ad-slot="7104125683" data-ad-format="auto"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div> 
            簡
單的測試每個人都會寫。例如，現在測試人員撰寫測試案例，你負責提供測試案例的執行器（Test
runner），讓測試人員可以執行測試案例以觀看測試結果。<br>
      <br>
如果測試人員看到某個類別：<br>
      
      <div style="margin-left: 40px;"><span style="font-family: Courier New,Courier,monospace; font-weight: bold;">package
cc.openhome;<br>
public class Calculator {</span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;
public int plus(int op1, int op2) {</span><br>
      <span style="font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
...</span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;"></span>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;
}</span><span style="font-family: Courier New,Courier,monospace; font-weight: bold;"></span><span style="font-family: Courier New,Courier,monospace; font-weight: bold;"></span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;"></span>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">}</span><br>
      </div>
      <br>
      測試人員撰寫了以下的測試：<br>
      
      <div style="margin-left: 40px;"><span style="font-family: Courier New,Courier,monospace; font-weight: bold;">package
test.cc.openhome;<br>
import cc.openhome.Calculator;<br>
public class CalculatorTest {<br>
&nbsp;&nbsp;&nbsp; public static void testPlus() {</span><span style="font-family: Courier New,Courier,monospace; font-weight: bold;"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Calculator calculator = new
Calculator();<br>
      </span><span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
int expected = 3;</span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
int result = calculator.plus(1, 2);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(expected == result) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
System.out.println("成功！");<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
System.out.printf(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"失敗，預期為 %d，但是傳回 %d！%n", expected, result);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;
}<br>
}</span><span style="font-weight: bold;"></span><br>
      </div>
      <br>
為了讓測試人員可以執行測試，你撰寫了<span style="font-family: Courier New,Courier,monospace;">TestRunner給測試人員作為執行器</span>：<br>
      
      <div style="margin-left: 40px;">package
test.cc.openhome;<br>
      <br>
      public
class TestRunner {<br>
      &nbsp;&nbsp;&nbsp;
public static void main(String[] args) {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
CalculatorTest.testPlus();<br>
      &nbsp;&nbsp;&nbsp;
}<br>
      }<br>
      </div>
      <br>
      <br>
接著，<span style="font-family: Courier New,Courier,monospace;">開發人員在
Calculator</span>類別中新增了方法：<br>
      
      <div style="margin-left: 40px;"><span style="font-family: Courier New,Courier,monospace; font-weight: bold;">package
cc.openhome;</span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">public
class Calculator {<br>
&nbsp;&nbsp;&nbsp; ...<br>
      </span><span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;
public int minus(int op1, int op2) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...<br>
&nbsp;&nbsp;&nbsp; }</span><span style="font-family: Courier New,Courier,monospace; font-weight: bold;"></span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">}</span><br>
      </div>
      <br>
      於是測試人員又在<span style="font-family: Courier New,Courier,monospace;">CalculatorTest</span>中
撰寫了另一個測試：<br>
      
      <div style="margin-left: 40px;">package
test.cc.openhome;<br>
import cc.openhome.Calculator;<br>
public class CalculatorTest {<br>
&nbsp;&nbsp;&nbsp; ...<br>
      <br>
&nbsp;&nbsp;&nbsp; public static void testMinus() {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Calculator calculator = new
Calculator();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int expected = 1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int result =
calculator.minus(3, 2);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(expected == result) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
System.out.println("正確！");<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
System.out.printf(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"錯誤，傳回 %d，但應該是 %d！%n", result, expected);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp; }<br>
}<br>
      </div>
      <br>
      為了可以執行新的測試案例，你為測試人員<span style="font-family: Courier New,Courier,monospace;">修改了TestRunner</span>：<br>
      
      <div style="margin-left: 40px;">package
test.cc.openhome;<br>
      <br>
      public
class TestRunner {<br>
      &nbsp;&nbsp;&nbsp;
public static void main(String[] args) {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
CalculatorTest.testPlus();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CalculatorTest.testMinus();<br>
      &nbsp;&nbsp;&nbsp;
}<br>
      }<br>
      </div>
      <br>
接著測試人員執行測試，卻發現了結果報告中出現了「成功！」與「正確！」。你檢視測試人員撰寫的程式，發現當中<span style="font-family: Courier New,Courier,monospace;">testPlus()與
testMinus()</span>的程式流程類似，但報告訊息格式不一致。身為程式設
計師，馬上就想到重構（Refactor）一下，重複的部份可以提取出來：<br>
      
      <div style="margin-left: 40px;">package
test.cc.openhome;<br>
      public
class Assert {<br>
      &nbsp;&nbsp;&nbsp;
public static void assertEquals(int expected, int result) {<br>
      &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; if(expected == result) {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
System.out.println("正確！");<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
else {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
System.out.printf(<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"失敗，預期為 %d，但是傳回 %d！%n", expected, result);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<br>
      &nbsp;&nbsp;&nbsp;
}<br>
      }<br>
      </div>
      <br>
      你告訴測試人
員，除了TestRunner之外，現在要斷言可以使用Assert上的工具方法。現在測試人員將CalculatorTest修改如下：<br>
      <div style="margin-left: 40px;">package
test.cc.openhome;<br>
      import
cc.openhome.Calculator;<br>
      public
class CalculatorTest {<br>
      &nbsp;&nbsp;&nbsp;
public static void testPlus() {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Calculator calculator = new Calculator();<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
int expected = 3;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
int result = calculator.plus(1, 2);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Assert.assertEquals(expected, result);<br>
      &nbsp;&nbsp;&nbsp;
}<br>
      &nbsp;&nbsp;&nbsp;
public static void testMinus() {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Calculator calculator = new Calculator();<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
int expected = 1;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
int result = calculator.minus(3, 2);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Assert.assertEquals(expected, result);<br>
      &nbsp;&nbsp;&nbsp;
}<br>
      }<br>
      </div>
      <br>
      開發人員不斷地在<span style="font-family: Courier New,Courier,monospace;">Calculator中加入新的xxx
()方法，而測試人員不斷地在CalculatorTest增加testXxx()方法，而你得在TestRunner中加入新的
CalculatorT.testXXX()方法</span>。<br>
      <br>
你覺得很煩，雖然撰寫<span style="font-family: Courier New,Courier,monospace;">TestRunner</span>是
你的職責，但是不想陪測試人員耗下去，因為<span style="font-family: Courier New,Courier,monospace;">測試請求是無窮無盡地，絕對</span>沒
道理測試人員想增加一個測試，你就得修改一次<span style="font-family: Courier New,Courier,monospace;">TestRunner</span>。於
是你設計了一個介面：<br>
      
      <div style="margin-left: 40px;"><span style="font-weight: bold;">package test.cc.openhome;</span><br>
      <span style="font-weight: bold;">public interface Test {</span><br>
      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; void run();</span><br>
      <span style="font-weight: bold;">}</span><br>
      </div>
      <br>
然後將<span style="font-family: Courier New,Courier,monospace;">TestRunner修
改如下</span>：<br>
      
      <div style="margin-left: 40px;">package
test.cc.openhome;<br>
      import
java.util.*;<br>
      public
class TestRunner {<br>
      &nbsp;&nbsp;&nbsp;
private List&lt;Test&gt; tests;<br>
      &nbsp;&nbsp;&nbsp;
public TestRunner() {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
tests = new ArrayList&lt;Test&gt;();<br>
      &nbsp;&nbsp;&nbsp;
}<br>
      &nbsp;&nbsp;&nbsp;
public void add(Test test) {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
tests.add(test);<br>
      &nbsp;&nbsp;&nbsp;
}<br>
      &nbsp;&nbsp;&nbsp;
public void run() {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
for(Test test : tests) {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test.run();<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<br>
      &nbsp;&nbsp;&nbsp;
}<br>
      }<br>
      </div>
      <br>
你想下班了，你告訴測試人員，現在測試案例要實作<span style="font-family: Courier New,Courier,monospace;">Test</span>介面。例如：<br>
      
      <div style="margin-left: 40px;">package
test.cc.openhome;<br>
      import
cc.openhome.Calculator;<br>
      public
class CalculatorPlusTest implements Test {<br>
      &nbsp;&nbsp;&nbsp;
@Override<br>
      &nbsp;&nbsp;&nbsp;
public void run() {<br>
      &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; Calculator calculator = new Calculator();<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
int expected = 3;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
int result = calculator.plus(1, 2);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Assert.assertEquals(expected, result);<br>
      &nbsp;&nbsp;&nbsp;
}<br>
      }<br>
      </div>
      <br>
      
      <div style="margin-left: 40px;"><span style="font-family: Courier New,Courier,monospace; font-weight: bold;">package
test.cc.openhome;</span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">import
cc.openhome.Calculator;</span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">public
class CalculatorMinusTest implements Test {</span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;
@Override</span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;
public void run() {</span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; Calculator calculator = new Calculator();</span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
int expected = 1;</span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
int result = calculator.minus(3, 2);</span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Assert.assertEquals(expected, result);</span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;
}</span><br>
      <span style="font-family: Courier New,Courier,monospace; font-weight: bold;">}</span><br>
      </div>
      <br>
      新的<span style="font-family: Courier New,Courier,monospace;">TestRunner</span>也
給測試人員了，這個<span style="font-family: Courier New,Courier,monospace;">TestRunner</span>可
以讓測試人員自由增加測試案例，然後執行測試：<br>
      
      <div style="margin-left: 40px;">package
test.cc.openhome;<br>
      public
class CalculatorTest {<br>
      &nbsp;&nbsp;&nbsp;
public static void main(String[] args) {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TestRunner runner = new TestRunner();<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
runner.add(new CalculatorPlusTest());<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
runner.add(new CalculatorMinusTest());<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
runner.run();<br>
      &nbsp;&nbsp;&nbsp;
}<br>
      }<br>
      </div>
      <br>
      畢竟，測試案例如何撰寫與添加是由測試人員掌握，應該要有一個執行器，可以單純地接受測試案例並執行。<br>
      <br>
現在測試人員與開發人員繼續留下來繼續寫他的<span style="font-family: Courier New,Courier,monospace;">測試</span>案例，不過<span style="font-family: Courier New,Courier,monospace;">你的TestRunner目前不用再修改
了</span>，所以可以下班回家逍遙了。<br>
      <br>
這其實就是 <a href="../DesignPattern/CommandPattern.htm">Command
模式</a> 的實現。<br>
      <br>
故事往往不會這麼就結束...XD<br>
      <br>
      <br>




<br><br><div class="ad336-280" style="text-align: center;"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- 2015 新版型廣告 336 x 280 --><ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-9750319131714390" data-ad-slot="9976409681"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div><br><div class="recommend" style="text-align: center;"><hr><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- 自動大小回應相符內容 --><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9750319131714390" data-ad-slot="4953478487" data-ad-format="autorelaxed"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></article></main></div></body>
<script src="../js/ui.js"></script>
</html>
<div class="analytics"><script async src="https://www.googletagmanager.com/gtag/js?id=G-QVQQYFSC8J"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-QVQQYFSC8J');</script></div>
