<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>








  
  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">








  
  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">








  
  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type">








  
  
  
  
  
  
  
  
  <title>製作 Executable JAR</title>
</head>


<body>








<h3><a href="../index.html">From
Gossip@Openhome</a></h3>








<h1><a href="index.html">Java Gossip: 製作 Executable JAR</a></h1>







<center>
<script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></center>
<br><br><br>

<span style="font-weight: bold;"></span>撰寫Java程式到這邊，相信您一定會有所疑問的是，編出來的.class檔案越來越多，難道要將這一堆.class檔案直接給想要執行程式的人嗎？在Windows下的話，有沒有辦法按一下檔案，就可以執行程式呢？<br>
<br>
當然，實際上要交付程式時，並不是給一堆.class檔案，而是會將編譯好的.class檔包裝為一個Java Archive File，也就是副檔名為.jar的檔案，在JDK的bin目錄下，附帶有一個jar工具程式，您可以直接執行jar程式，看看它的提示訊息：<br>
<img style="width: 825px; height: 511px;" alt="JAR" title="JAR" src="images/J6-015.JPG"><br>
<br>
直接執行jar工具程式，提示訊息中已清楚的說明如何使用jar程式，在這邊使用&nbsp;<a href="http://epaper.gotop.com.tw/pdf/ACL020931.pdf">文字編輯器製作</a> 完成的文字編輯器為例，來示範如何將程式包裝為.jar的檔案，首先請建立一個jar目錄，並在其下建立bin與classes目錄，將您完成的文字編輯器程式放入classes中（包括套件的資料夾結構），待會將會產生的.jar則將放入bin中。<br>
<img style="width: 578px; height: 372px;" alt="準備製作JAR" title="準備製作JAR" src="images/J6-016.JPG"><br>
<br>
接著開啟文字模式，切換工作目錄至jar目錄下，然後鍵入以下的指令，表示將建立一個JNotePad.jar放到bin目錄中，來源是classes中的檔案，被放入的檔案將以/作為.jar檔案中的根目錄：<br>
<img style="width: 805px; height: 384px;" alt="製作JAR" title="製作JAR" src="images/J6-017.JPG"><br>
<br>
接著您的bin目錄中就會產生一個JNotePad.jar，要如何使用這個.jar檔案呢？.jar檔案中包括.class，基本上可以將.jar看作是一個特別的目錄，所以要使用.jar檔案中的.class檔案時，基本上也是指定Classpath，例如：<br>







<table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">







  <tbody>







    <tr>







      <td style="background-color: rgb(0, 0, 0);"><small><span style="color: rgb(255, 255, 255);">java -cp ./bin/JNotePad.jar onlyfun.caterpillar.JNotePad</span></small><span style="color: rgb(255, 255, 255);"><br>







      </span></td>







    </tr>







  
  
  
  
  
  
  
  </tbody>
</table>






<br>
接著您的文字編輯器就會啟動了，現在您不用將一堆.class檔案交付出去，只要交付這個JNotePad.jar就可以了。<br>
<br>
然而，真的要指定Classpath這麼麻煩嗎？其實還有更方便的做法，製作一個Executable Jar檔案，指定讀取.jar檔案時要執行的Main-Class就可以了，這需要準備一個manifest.txt，當中寫下：<br>
<img style="width: 524px; height: 95px;" alt="MANIFEST" title="MANIFEST" src="images/J6-018.JPG"><br>
<br>
注意寫完Main-Class之後，要按下Enter鍵新增一行，在Windows下這個動作是必要的，否則會發生無法讀取Main-Class屬性的錯誤。假設manifest.txt放在jar目錄下，接著如下執行指令：<br>
<img style="width: 805px; height: 384px;" alt="製作 Executable JAR" title="製作 Executable JAR" src="images/J6-019.JPG"><br>
<br>
在.jar檔案製作出來後，您可以在執行java時指定-jar引數，以及您的.jar檔案，java程式會自動尋找Main-Class並執行，例如下達以下的指令：<br>
<table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">







  <tbody>







    <tr>







      <td style="background-color: rgb(0, 0, 0);"><small><span style="color: rgb(255, 255, 255);">java -jar bin/JNotePad.jar</span></small><span style="color: rgb(255, 255, 255);"><br>







      </span></td>







    </tr>







  
  
  
  
  
  
  
  </tbody>
</table>






<br>
接著您的文字編輯器就會啟動了，如果您的作業系統是Windows，由於安裝完JRE之後，會將.jar預設由javaw程式開啟，所以您可以直接在JNotePad.jar檔案上，使用滑鼠左鍵按兩下直接開啟程式來執行。
<br>
<br>




<center>
<script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></center>




</body>
</html>
<div class="analytics"><script async src="https://www.googletagmanager.com/gtag/js?id=G-QVQQYFSC8J"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-QVQQYFSC8J');</script></div>