<!DOCTYPE html>
<html lang="zh-tw">
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="如
果要取得使用者的輸入，可以使用ARGV，使用者輸入的命令列引數，會收集為字串陣列並給ARGV參考。例如：
            
        hello.rb      
...">
    <meta property="og:locale" content="zh_TW">
    <meta property="og:title" content="基本輸入輸出">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://openhome.cc/Gossip/Ruby/BasicIO.html">
    <meta property="og:image" content="https://openhome.cc/Gossip/images/caterpillar_small.jpg">
    <meta property="og:site_name" content="OPENHOME.CC">
    <meta property="og:description" content="如
果要取得使用者的輸入，可以使用ARGV，使用者輸入的命令列引數，會收集為字串陣列並給ARGV參考。例如：
            
        hello.rb      
...">
    <title>基本輸入輸出</title>
    <link rel="stylesheet" href="../css/pure-0.6.0/pure-min.css">
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="../css/layouts/side-menu-old-ie.css">    <![endif]-->
    <!--[if gt IE 8]><!-->
    <link rel="stylesheet" href="../css/layouts/side-menu.css">
    <!--<![endif]-->
    <link rel="stylesheet" href="../css/caterpillar.css">
    <script async="" src="../google-code-prettify/run_prettify.js"></script>
  <!-- 網頁層級廣告 --><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle =window.adsbygoogle || []).push({google_ad_client: "ca-pub-9750319131714390",enable_page_level_ads: true });</script></head>
  <body>
    <div id="layout">
      <!-- Menu toggle --> <a href="BasicIO.html#menu" id="menuLink" class="menu-link">
        <!-- Hamburger icon --> <span></span> </a>
      <div id="menu">
        <div class="pure-menu"> <a class="pure-menu-heading" href="index.html">回
            Ruby 目錄</a>
          <ul class="pure-menu-list">
            <br>
            <div class="social" style="text-align: center;"><a href="http://twitter.com/caterpillar"><img
                  title="Twitter" alt="Twitter" src="../images/twitter.png"></a>
              <a href="http://www.facebook.com/openhome.cc"><img title="Facebook"
                  alt="Facebook" src="../images/facebook.png"></a>
              </div>
            <br>
            <div id="search box">
              <script>(function() {var cx = 'partner-pub-9750319131714390:3926766884';var gcse = document.createElement('script');gcse.type = 'text/javascript';gcse.async = true;gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//www.google.com/cse/cse.js?cx=' + cx;var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(gcse, s);})();</script><gcse:searchbox-only></gcse:searchbox-only></div>
            <br>
            <div class="ad" style="text-align: center;">
              <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
              <!-- 2015 新版型 160 x 600 廣告 -->
              <ins class="adsbygoogle" style="display:inline-block;width:160px;height:600px"
                data-ad-client="ca-pub-9750319131714390" data-ad-slot="3747048883"></ins>
              <script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
          </ul>
        </div>
      </div>
      <main id="main">
        <header class="header">
          <h1>基本輸入輸出</h1>
        </header>
        <article class="content"><br>
          <div class="ad-3" style="text-align: center;">
            <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- 2015 新版型回應式廣告 --><ins
              class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9750319131714390"
              data-ad-slot="7104125683" data-ad-format="auto"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div>
          如
          果要取得使用者的輸入，可以使用<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">ARGV</span>，
          使用者輸入的命令列引數，會收集為字串陣列並給ARGV參考。例如：<br>
          <ul>
            <li>hello.rb</li>
          </ul>
          <pre class="prettyprint"><code lang="ruby">print "Hello, ", ARGV[0], "\n"</code></pre>
          <br>
          如下執行指令載入指令稿直譯並執行：<br>
          <div class="cmd"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;
ruby
hello.rb
                caterpillar</span><br>
              Hello!caterpillar!<br>
              <br>
              <span style="font-weight: bold;">
                &gt;</span><br>
            </span><span style="color: rgb(255, 255, 255);"> </span></div>
          <br>
          上面這個範例可以更簡潔地寫為以下：<br>
          <ul>
            <li>hello.rb</li>
          </ul>
          <pre class="prettyprint"><code lang="ruby">puts "Hello, #{ARGV[0]}"<br></code></pre>
          <br>
          如果字串中包括<span style="font-weight: bold; font-family: Courier New,Courier,monospace;">#{}</span><span
            style="font-family: Courier New,Courier,monospace;">，括號中若指定了某個變數名稱，則
            直譯器會嘗試取得變數值後與字串結合。預設輸出會使用標準輸出<span style="font-weight: bold;">STDOUT</span>，
            如果想使用標準錯誤輸出，可以指定<span style="font-weight: bold;">STDERR</span>。例如：<br>
          </span>
          <ul>
            <li>hello.rb</li>
          </ul>
          <pre class="prettyprint"><code lang="ruby">STDERR.print "Hello, #{ARGV[0]}"<br></code></pre>
          <span style="font-family: Courier New,Courier,monospace;"><br>
          </span>在程式執行的過程中，可以使用<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">gets</span><span
            style="font-family: Courier New,Courier,monospace;">方法</span>取得使用者的輸
          入，<span style="font-family: Courier New,Courier,monospace;"></span>使用者
          輸入文字後按下Enter，<span style="font-family: Courier New,Courier,monospace;">gets</span>會
          以字串傳回使用者的輸入，取得的字串會包括換行字元。例如：<br>
          <ul>
            <li>hello.rb</li>
          </ul>
          <pre class="prettyprint"><code lang="ruby">print "Input your name: "<br>name = gets<br>puts "Hello, #{name}!"<br></code></pre>
          <span style="font-family: Courier New,Courier,monospace;"><br>
          </span>如下執行指令載入指令稿直譯並執行：<br>
          <div class="cmd"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;ruby
                main.rb</span><br>
              Input your name: Justin<br>
              Hello, Justin<br>
              !<br>
              <br>
              <span style="font-weight: bold;">
                &gt;</span></span><span style="color: rgb(255, 255, 255);"><br>
            </span></div>
          <br>
          注意最後一個行才出現<span style="font-family: Courier New,Courier,monospace;">!</span>，
          這是因為<span style="font-family: Courier New,Courier,monospace;">name</span>變
          數參考的字串，最後包括空白字元。如果想裁剪掉字串尾端空白字元，像是換行字元，可以使用字串物件的<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">chomp</span>方
          法。例如：<br>
          <ul>
            <li>hello.rb</li>
          </ul>
          <pre class="prettyprint"><code lang="ruby">print "Input your name: "<br>name = gets.chomp<br>puts "Hello, #{name}!"<br></code></pre>
          <br>
          執行結果如下，!會緊接在同一行後，這是因為name變數參考的字串尾端空白已被chomp裁掉：<br>
          <div class="cmd"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;ruby
                main.rb</span><br>
              Input your name: Justin<br>
              Hello, Justin!<br>
              <br>
              <span style="font-weight: bold;">
                &gt;</span></span><span style="color: rgb(255, 255, 255);"><br>
            </span></div>
          <br>
          到目前為止，輸出都是使用<span style="font-family: Courier New,Courier,monospace;">print
            或puts方法，print方法可以使用逗號區隔想輸出的文字，如第一個範例所示，puts也可以，不過要注意，每個文字都會被換行。例如：<br>
          </span>
          <ul>
            <li>main.rb</li>
          </ul>
          <pre class="prettyprint"><code lang="ruby">puts "This ", "is ", "a ", "test", "!"<br></code></pre>
          <span style="font-family: Courier New,Courier,monospace;"><br>
            執行結果如下：</span><br>
          <div class="cmd"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;ruby
                main.rb</span><br>
              This<br>
              is<br>
              a<br>
              test<br>
              !<br>
              <br>
              <span style="font-weight: bold;">
                &gt;</span></span><span style="color: rgb(255, 255, 255);"><br>
            </span></div>
          <br>
          如果要格式化輸出，可以使用<span style="font-weight: bold;">printf</span>方法。例如：<br>
          <div class="cmd"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt;
                printf("%d %.2f %s\n", 1, 99.3, "Justin")</span><br>
              1 99.30 Justin<br>
              =&gt; nil<br>
              <span style="font-weight: bold;">
                &gt;&gt;</span></span><span style="color: rgb(255, 255, 255);"><br>
            </span></div>
          <br>
          格式化輸出時，所使用的%d、%f、%s等與C語言類似，如果只是要格式化字串，則可以使用<span style="font-weight: bold;">sprintf</span>方
          法。例如：<br>
          <div class="cmd"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt;
                x = sprintf "%d %.2f %s", 1, 99.3, "Justin"</span><br>
              =&gt; "1 99.30 Justin"<br>
              <span style="font-weight: bold;">
                &gt;&gt; puts x</span><br>
              1 99.30 Justin<br>
              =&gt; nil<br>
              <span style="font-weight: bold;">
                &gt;&gt;</span></span><span style="color: rgb(255, 255, 255);"><br>
            </span></div>
          <br>
          格式化字串另一個簡便的方式，是透過%與陣列，例如：<br>
          <div class="cmd"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt;
                x = "%d %.2f %s" % [1, 99.3, "Justin"]</span><br>
              =&gt; "1 99.30 Justin"<br>
            </span><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">
                &gt;&gt; puts x</span><br>
              1 99.30 Justin<br>
              =&gt; nil<br>
              <span style="font-weight: bold;">
                &gt;&gt;</span></span><span style="color: rgb(255, 255, 255);"><br>
            </span></div>
          <br>
          如果要將使用者的輸入字串轉換為整數、浮點等型態，可以使用<span style="font-family: Courier New,Courier,monospace;"><span
              style="font-weight: bold;">to_i</span>、<span style="font-weight: bold;">to_f</span>方
            法</span>。例如：<br>
          <div class="cmd"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt;
                "1".to_i</span><br>
              =&gt; 1<br>
              <span style="font-weight: bold;">
                &gt;&gt; "3.14".to_f</span><br>
              =&gt; 3.14<br>
              <span style="font-weight: bold;">
                &gt;&gt; "3.14".to_f + 123</span><br>
              =&gt; 126.14<br>
              <span style="font-weight: bold;">
                &gt;&gt;</span></span><span style="color: rgb(255, 255, 255);"><br>
            </span></div>
          <br>
          to_i、to_f方法比較寬鬆，如果字串後段混有非數字部份，只會對數字部份予以剖析，如果不想要這個結果，可以使用Integer或Float。
          例如：<br>
          <div class="cmd"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt;
                "123one".to_i<br>
              </span>=&gt; 123<span style="font-weight: bold;"><br>
                &gt;&gt; Integer("123one")<br>
              </span>ArgumentError: invalid value for Integer(): "123one"<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; from (irb):2:in
              `Integer'<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; from (irb):2<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; from
              C:/Winware/Ruby192/bin/irb:12:in `&lt;main&gt;'<br>
              <span style="font-weight: bold;">&gt;&gt; "3.14abc".to_f<br>
              </span>=&gt; 3.14<span style="font-weight: bold;"><br>
                &gt;&gt; Float("3.14abc")<br>
              </span>ArgumentError: invalid value for Float(): "3.14abc"<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; from (irb):5:in `Float'<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; from (irb):5<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; from
              C:/Winware/Ruby192/bin/irb:12:in `&lt;main&gt;'<br>
              <span style="font-weight: bold;">&gt;&gt;</span><span style="font-weight: bold;"></span></span><span
              style="color: rgb(255, 255, 255);"><br>
            </span></div>
          <br>
          gets方法是從標準輸入<span style="font-weight: bold;">STDIN</span>取得字串，如果想要讀取檔
          案，可以使用<span style="font-weight: bold;">File.read</span>方法。例如：<br>
          <ul>
            <li>main.rb</li>
          </ul>
          <pre class="prettyprint"><code lang="ruby">print "File name: "<br>name = gets.chomp<br>content = File.read(name)<br>puts content<br></code></pre>
          <br>
          <span style="font-family: Courier New,Courier,monospace;">File.read會一次
            讀取檔案所有內容，如果想要逐行讀取檔案內容，可以使用<span style="font-weight: bold;">open</span>方
            法。例如：</span><br>
          <ul>
            <li>main.rb</li>
          </ul>
          <pre class="prettyprint"><code lang="ruby">print "File name: "<br>name = gets.chomp<br>file = open(name, "r") # "r" 表示檔案供讀取使用<br>while line = file.gets<br>    print line<br>end<br>file.close<br></code></pre>
          <br>
          <span style="font-family: Courier New,Courier,monospace;">gets</span>若
          讀到檔案結束，會傳回<span style="font-family: Courier New,Courier,monospace;">nil</span>，
          這在布林判斷時會作為不成立，因此離開迴圈，<span style="font-family: Courier New,Courier,monospace;">在
            不使用檔案時，可以使用<span style="font-weight: bold;">close</span>將檔案關閉以節省資源。</span>另
          一個比較簡潔的方式，是使用區塊方式撰寫讀取邏輯。例如：<br>
          <ul>
            <li>main.rb</li>
          </ul>
          <pre class="prettyprint"><code lang="ruby">print "File name: "<br>name = gets.chomp<br>file = open(name, "r")<br>file.each do |line|<br>    print line<br>end<br>file.close<br></code></pre>
          <br>
          <span style="font-family: Courier New,Courier,monospace;">open之後傳回的物件，
            會有each方法，會將讀入的每一行設定給|line|中的line，open本身也有區塊式寫法。例如：</span><br>
          <ul>
            <li>main.rb</li>
          </ul>
          <pre class="prettyprint"><code lang="ruby">print "File name: "<br>name = gets.chomp<br>open(name, "r") do |file|<br>    file.each do |line|<br>        print line<br>    end<br>end<br></code></pre>
          <br>
          open之後傳回的物件，會指定給|file|中的file參考，執行完區塊後會自動關閉檔案。區塊寫法牽涉到迭代器等細節，現階段你只要記得有這種
          寫法，技術細節在之後的文件還會介紹。<br>
          <br>
          <span style="font-family: Courier New,Courier,monospace;">如果要寫資料至檔案，則在
            使用open方法時，指定模式為"w"，並使用<span style="font-weight: bold;">print、puts</span>等
            方法進行資料寫入。例如：<br>
          </span><span style="font-family: Courier New,Courier,monospace;"></span>
          <pre class="prettyprint"><code lang="ruby">print "File name: "<br>name = gets.chomp<br>open(name, "w") do |file|<br>    file.print "test"<br>end<br></code></pre>
          <span style="font-family: Courier New,Courier,monospace;"><br>
            如果要以位元組方式讀入檔案，可以使用File實例的each_byte讀入位元組資料，如果要寫出位元組資料至檔案，可以使用File物件的
            print方法，將包括位元組內容的字串寫出。例如：<br>
          </span>
          <ul>
            <li>main.rb</li>
          </ul>
          <pre class="prettyprint"><code lang="ruby">print "Src: "<br>src = gets.chomp<br>print "Dest: "<br>dest = gets.chomp<br>open(src, "rb") do |r_file|<br>    open(dest, "wb") do |w_file|<br>        r_file.each_byte do |byte|<br>            w_file.print([byte].pack("c*"))<br>        end<br>    end<br>end<br></code></pre>
          <span style="font-family: Courier New,Courier,monospace;"> </span><br>
          其中b指定用二進位方式開檔，pack是Array實例的方法，指定"c*"表示將位元組資料包裝為字串（ASCII-8BIT）。如果需要更低階的
          操作，可以使用繼承自IO物件的 <a href="http://ruby-doc.org/docs/ProgrammingRuby/html/ref_c_io.html#IO.sysread">sysread</a>
          與 <a href="http://ruby-doc.org/docs/ProgrammingRuby/html/ref_c_io.html#IO.syswrite">syswrite</a>
          方法。<br>
          <br>
          有關於不同編碼的檔案讀寫，則可以參考 <a href="https://openhome.cc/Gossip/Ruby/Encoding.html">關於編碼</a>。<br>
          <br>
          <br>
          <br>
          <div class="ad336-280" style="text-align: center;">
            <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- 2015 新版型廣告 336 x 280 --><ins
              class="adsbygoogle" style="display:inline-block;width:336px;height:280px"
              data-ad-client="ca-pub-9750319131714390" data-ad-slot="9976409681"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div>
          <br>
          <div class="recommend" style="text-align: center;">
            <hr>
            <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- 自動大小回應相符內容 --><ins
              class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9750319131714390"
              data-ad-slot="4953478487" data-ad-format="autorelaxed"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div>
        </article>
      </main>
    </div></body>
    <script src="../js/ui.js"></script>
    <div class="analytics"><script async src="https://www.googletagmanager.com/gtag/js?id=G-QVQQYFSC8J"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-QVQQYFSC8J');</script></div>

</html>
