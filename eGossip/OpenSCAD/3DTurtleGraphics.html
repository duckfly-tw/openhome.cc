<!doctype html><html lang="en-us">
<head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="In 2D turtle graphics, a turtle crawls and leaves footprints on a beach. If the turtle dives into th...">

<meta property="og:locale" content="en_US">
<meta property="og:title" content="3D turtle graphics">
<meta property="og:type" content="article">
<meta property="og:url" content="https://openhome.cc/eGossip/OpenSCAD/3DTurtleGraphics.html">
<meta property="og:image" content="https://openhome.cc/Gossip/images/caterpillar_small.jpg">
<meta property="og:site_name" content="OPENHOME.CC">
<meta property="og:description" content="In 2D turtle graphics, a turtle crawls and leaves footprints on a beach. If the turtle dives into th...">

    <title>3D turtle graphics</title>

<link rel="stylesheet" href="http://openhome.cc/Gossip/css/pure-0.6.0/pure-min.css">

    <!--[if lte IE 8]>
        <link rel="stylesheet" href="../../Gossip/css/layouts/side-menu-old-ie.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="http://openhome.cc/Gossip/css/layouts/side-menu.css">
    <!--<![endif]-->
  

     <link rel="stylesheet" href="http://openhome.cc/Gossip/css/caterpillar.css">
     <script async src="http://openhome.cc/Gossip/google-code-prettify/run_prettify.js"></script>
<!-- 網頁層級廣告 --><script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle =window.adsbygoogle || []).push({google_ad_client: "ca-pub-9750319131714390",enable_page_level_ads: true });</script></head>
<body>

<div id="layout">
    <!-- Menu toggle -->
    <a href="3DTurtleGraphics.html#menu" id="menuLink" class="menu-link">
        <!-- Hamburger icon -->
        <span></span>
    </a>
    <div id="menu">
        <div class="pure-menu">
            <a class="pure-menu-heading" href="http://openhome.cc/eGossip/OpenSCAD/index.html">&lt;&lt; OpenSCAD TOC</a>
            <ul class="pure-menu-list">
                <li class="pure-menu-item"><br><div class="social" style="text-align: center;"><a href="http://twitter.com/caterpillar"><img title="Twitter" alt="Twitter" src="../../Gossip/images/twitter.png"></a> <a href="http://www.facebook.com/openhome.cc"><img title="Facebook" alt="Facebook" src="../../Gossip/images/facebook.png"></a> </div><br> <div id="search box"><script>(function() {var cx = 'partner-pub-9750319131714390:3926766884';var gcse = document.createElement('script');gcse.type = 'text/javascript';gcse.async = true;gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//www.google.com/cse/cse.js?cx=' + cx;var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(gcse, s);})();</script><gcse:searchbox-only></gcse:searchbox-only></div><br><div class="ad" style="text-align: center;"><script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 2015 新版型 160 x 600 廣告 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:160px;height:600px"
     data-ad-client="ca-pub-9750319131714390"
     data-ad-slot="3747048883"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div></li>
            </ul>
        </div>
    </div>

    <main id="main">
        <header class="header">
            <h1>3D turtle graphics</h1>
        </header>

        <article class="content">
            <br><div class="ad-3" style="text-align: center;"><script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- 2015 新版型回應式廣告 --><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9750319131714390" data-ad-slot="7104125683" data-ad-format="auto"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div> 
            
            <p>In <a href="TurtleGraphics.html">2D turtle graphics</a>, a turtle crawls and leaves footprints on a beach. If the turtle dives into the ocean, it swims and leaves a trace, what will happen?</p>
<p><div class="pure-g"><div class="pure-u-1"><img class="pure-img-responsive" src="../../Gossip/ComputerGraphics/images/threeDimTurtle-1.jpg" alt="3D turtle graphics"  /></div></div></p>
<h1>A simple thought?</h1>
<p>We've realized <a href="TurtleGraphics.html">2D turtle graphics</a>. When it comes to 3D turtle graphics, you might have a simple thought that we can just raise and record the angle of the turtle's head.</p>
<p><div class="pure-g"><div class="pure-u-1"><img class="pure-img-responsive" src="images/3DTurtleGraphics-1.JPG" alt="3D turtle graphics"  /></div></div></p>
<p>This benefit of this solution is, we can only add calculation about φ into our code of <a href="TurtleGraphics.html">2D turtle graphics</a>. It looks easy, but we'll have only two degrees of freedom, turning around the z-axis and raising the head. The other problem is if you want to draw a triangle on a plane which has 30 degrees from the xy plane, how to command the turtle?</p>
<p><div class="pure-g"><div class="pure-u-1"><img class="pure-img-responsive" src="images/3DTurtleGraphics-2.JPG" alt="3D turtle graphics"  /></div></div></p>
<p>You might command the turtle to forward, turn 120 degrees, raise 30 degrees, forward and so on. Unfortunately, this is wrong. In fact, the turtle has to turn 125.264 at the first time. (You can prove it by yourself.) That is, this solution is workable but troublesome.</p>
<h1>Thinking in vectors</h1>
<p>Suppose we have a turtle which head is toward the positive direction of the x-axis. If you sit on the turtle, you have your coordinate system. From your viewpoint, the coordinates of something are given by x' and y'.</p>
<p><div class="pure-g"><div class="pure-u-1"><img class="pure-img-responsive" src="images/3DTurtleGraphics-3.JPG" alt="3D turtle graphics"  /></div></div></p>
<p>Suppose we use a vector (1, 0) to represent the unit vector in the positive direction of the x'-axis. Similarly, we use a vector (0, 1) to represent the unit vector in the positive direction of the y'-axis. Now the turtle turns θ degrees.</p>
<p><div class="pure-g"><div class="pure-u-1"><img class="pure-img-responsive" src="images/3DTurtleGraphics-4.JPG" alt="3D turtle graphics"  /></div></div></p>
<p>From the viewpoint of the xy-coordinate system, we can obtain the new unit vectors of (1, 0) and (1, 0) by rotating them around the z-axis respectively. <a href="https://en.wikipedia.org/wiki/Rotation_of_axes">Rotation of axes</a> lists the equations defining the transformation in two dimensions.</p>
<p>A simple case is, suppose θ is 45 degrees, from the viewpoint of the xy-coordinate system, the unit vector of the x'-axis is <code>(1 / sqrt(2), 1 / sqrt(2))</code>, and the unit vector of the y'-axis is <code>(- 1 / sqrt(2), 1 / sqrt(2))</code>. If we forward the turtle a length of <code>L</code>, the path vector is <code>(L * 1 / sqrt(2), L * 1 / sqrt(2))</code>. That is, the unit vector of the x'-axis is multiplied by <code>L</code> to obtain the orange vector in the following picture.</p>
<p><div class="pure-g"><div class="pure-u-1"><img class="pure-img-responsive" src="images/3DTurtleGraphics-5.JPG" alt="3D turtle graphics"  /></div></div></p>
<p>Therefore, when forwarding from a point (x1, y2), the new point is <code>(x1 + L * 1 / sqrt(2), y1 + L * 1 / sqrt(2))</code>.</p>
<p>In <a href="TurtleGraphics.html">2D turtle graphics</a>, we only forward the turtle in the x-axis and don't care about forwarding in the y-axis. The calculation is simplified, so we don't talk about vectors at that time.</p>
<h1>Realizing 3D turtle graphics</h1>
<p>We have a xyz-coordinate system. You sit on a turtle and have a x'y'z'-coordinate system from your viewpoint. The vector (1, 0, 0), (0, 1, 0), (0, 0, 1) represents the unit vectors of x', y' and z' from the viewpoint of the xyz-coordinate system.</p>
<p><div class="pure-g"><div class="pure-u-1"><img class="pure-img-responsive" src="images/3DTurtleGraphics-6.JPG" alt="3D turtle graphics"  /></div></div></p>
<p>Similarly, we can use the equations of <a href="https://en.wikipedia.org/wiki/Rotation_of_axes">Rotation of axes</a> to obtain new unit vectors after rotating. If you forward the turtle a length of <code>L</code>, you can multiply the unit vector of x' by <code>L</code> to obtain the path vector. Combine the path vector with the start point of the turtle; you can get the new point after moving.</p>
<p>From the above, we implement the following code. To draw lines in 3D coordinates, we use the <code>polyline3D</code> module developed in <a href="Polyline3D.html">3D line</a>.</p>
<pre class="prettyprint"><code lang="openscad">function x(pt) = pt[0];
function y(pt) = pt[1];
function z(pt) = pt[2];

function pt3D(x, y, z) = [x, y, z];

function turtle3D(pt, coordVt) = [pt, coordVt];
function getPt(turtle) = turtle[0];
function getCoordVt(turtle) = turtle[1];

function plus(pt, n) = pt3D(x(pt) + n, y(pt) + n, z(pt) + n);
function minus(pt, n) = pt3D(x(pt) - n, y(pt) - n, z(pt) + n);
function mlt(pt, n) = pt3D(x(pt) * n, y(pt) * n, z(pt) * n);
function div(pt, n) = pt3D(x(pt) / n, y(pt) / n, z(pt) / n);
function neg(pt, n) = mlt(pt, -1);

function ptPlus(pt1, pt2) = pt3D(x(pt1) + x(pt2), y(pt1) + y(pt2), z(pt1) + z(pt2));

// forward the turtle in the x' direction
function moveX(turtle, leng) = turtle3D(
    ptPlus(getPt(turtle), mlt(getCoordVt(turtle)[0], leng)),
    getCoordVt(turtle)
);

// forward the turtle in the y' direction
function moveY(turtle, leng) = turtle3D(
    ptPlus(getPt(turtle), mlt(getCoordVt(turtle)[1], leng)),
    getCoordVt(turtle)
);

// forward the turtle in the z' direction
function moveZ(turtle, leng) = turtle3D(
    ptPlus(getPt(turtle), mlt(getCoordVt(turtle)[2], leng)),
    getCoordVt(turtle)
);

// turn the turtle around the x'-axis
// return a new unit vector
function turnX(turtle, a) = turtle3D(
    getPt(turtle),
    [
        getCoordVt(turtle)[0], 
        ptPlus(mlt(getCoordVt(turtle)[1], cos(a)), mlt(getCoordVt(turtle)[2], sin(a))), 
        ptPlus(mlt(neg(getCoordVt(turtle)[1]), sin(a)), mlt(getCoordVt(turtle)[2], cos(a)))
    ]
);

// turn the turtle around the y'-axis
// return a new unit vector
function turnY(turtle, a) = turtle3D(
    getPt(turtle),
    [
        ptPlus(mlt(getCoordVt(turtle)[0], cos(a)), mlt(neg(getCoordVt(turtle)[2]), sin(a))),
        getCoordVt(turtle)[1], 
        ptPlus(mlt(getCoordVt(turtle)[0], sin(a)), mlt(getCoordVt(turtle)[2],cos(a)))
    ]
);

// turn the turtle around the z'-axis
// return a new unit vector
function turnZ(turtle, a) = turtle3D(
    getPt(turtle),
    [
        ptPlus(mlt(getCoordVt(turtle)[0], cos(a)), mlt(getCoordVt(turtle)[1],sin(a))),
        ptPlus(mlt(neg(getCoordVt(turtle)[0]), sin(a)), mlt(getCoordVt(turtle)[1], cos(a))),
        getCoordVt(turtle)[2], 
    ]
);

// 3D lines
module line3D(p1, p2, thickness, fn = 24) {
    $fn = fn; 

    hull() {
        translate(p1) sphere(thickness / 2);
        translate(p2) sphere(thickness / 2);
    }
}

module polyline3D(points, thickness, fn) {
    module polyline3D_inner(points, index) {
        if(index &lt; len(points)) {
            line3D(points[index - 1], points[index], thickness, fn);
            polyline3D_inner(points, index + 1);
        }
    }

    polyline3D_inner(points, 1);
}

t = turtle3D(
    pt3D(0, 0, 0), 
    [pt3D(1, 0, 0), pt3D(0, 1, 0), pt3D(0, 0, 1)] // unit vectors from the turtle's viewpoint
);

leng = 10;

t2 = moveX(t, leng);
polyline3D([getPt(t), getPt(t2)], 1 , 4);

t3 = moveX(turnZ(t2, 120), leng);
polyline3D([getPt(t2), getPt(t3)], 1 , 4);

t4 = moveX(turnZ(t3, 120), leng);
polyline3D([getPt(t3), getPt(t4)], 1 , 4);
</code></pre>
<p>The above code is the realization of 3D turtle graphics. It can, of course, draw 2D lines on the xy plane. The above code only draws a triangle on the xy plane.</p>
<p><div class="pure-g"><div class="pure-u-1"><img class="pure-img-responsive" src="images/3DTurtleGraphics-7.JPG" alt="3D turtle graphics"  /></div></div></p>
<p>If you want to do the task mentioned in the above: draw a triangle on a plane which has 30 degrees from the xy plane, how to command the turtle now? You just have to turn the turtle 30 degrees around the x'-axis. After that, the turtle has 30 degrees from the xy plain. Now, from the turtle's viewpoint, turn 120 degrees around the z'-axis and draw one side. Repeat the actions two times. You'll do it. Sound like drawing a triangle on the 2D plain? You are right.</p>
<pre class="prettyprint"><code lang="openscad">// omitted...the same as the previous code

leng = 10;

// Just change the line below. Turn 30 degrees around the x'-axis first. 
t2 = moveX(turnX(t, 30), leng);
polyline3D([getPt(t), getPt(t2)], 1 , 4);

t3 = moveX(turnZ(t2, 120), leng);
polyline3D([getPt(t2), getPt(t3)], 1 , 4);

t4 = moveX(turnZ(t3, 120), leng);
polyline3D([getPt(t3), getPt(t4)], 1 , 4);
</code></pre>
<p><div class="pure-g"><div class="pure-u-1"><img class="pure-img-responsive" src="images/3DTurtleGraphics-8.JPG" alt="3D turtle graphics"  /></div></div></p>
<p>Surely, it needs more mathematics to realizing 3D turtle graphics. However, it's worth the effort. You can draw something like <a href="https://www.thingiverse.com/thing:1972495">Customizable tree curve</a>. Can you figure out how to draw it? I'll talk about it later; however, you can give it a try first.</p>

            
           <br><br><div class="ad336-280" style="text-align: center;"><script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- 2015 新版型廣告 336 x 280 --><ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-9750319131714390" data-ad-slot="9976409681"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div><br><div class="recommend" style="text-align: center;"><hr><script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- 自動大小回應相符內容 --><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9750319131714390" data-ad-slot="4953478487" data-ad-format="autorelaxed"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div>
        </article></main></div></body>
<script src="http://openhome.cc/Gossip/js/ui.js"></script>
</html>
<div class="analytics"><script async src="https://www.googletagmanager.com/gtag/js?id=G-QVQQYFSC8J"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-QVQQYFSC8J');</script></div>
