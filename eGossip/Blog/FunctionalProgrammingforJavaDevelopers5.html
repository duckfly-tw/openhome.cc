<!doctype html><html lang="en">
<head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Let's get back to the real Java. Java provides syntax to define abstract data types and write code i...">

<meta property="og:locale" content="en">
<meta property="og:title" content="Functional Programming for Java Developers, Part 5 - JDK8 Default Methods">
<meta property="og:type" content="article">
<meta property="og:url" content="https://openhome.cc/eGossip/Blog/FunctionalProgrammingforJavaDevelopers5.html">
<meta property="og:image" content="https://openhome.cc/Gossip/images/caterpillar_small.jpg">
<meta property="og:site_name" content="OPENHOME.CC">
<meta property="og:description" content="Let's get back to the real Java. Java provides syntax to define abstract data types and write code i...">


    <title>Functional Programming for Java Developers, Part 5 - JDK8 Default Methods</title>

<link rel="stylesheet" href="../../Gossip/css/pure-0.6.0/pure-min.css">

    <!--[if lte IE 8]>
        <link rel="stylesheet" href="../../Gossip/css/layouts/side-menu-old-ie.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="../../Gossip/css/layouts/side-menu.css">
    <!--<![endif]-->
  

     <link rel="stylesheet" href="../../Gossip/css/caterpillar.css">
     <script async src="../../Gossip/google-code-prettify/run_prettify.js"></script>
<!-- 網頁層級廣告 --><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle =window.adsbygoogle || []).push({google_ad_client: "ca-pub-9750319131714390",enable_page_level_ads: true });</script></head>
<body>

<div id="layout">
    <!-- Menu toggle -->
    <a href="FunctionalProgrammingforJavaDevelopers5.html#menu" id="menuLink" class="menu-link">
        <!-- Hamburger icon -->
        <span></span>
    </a>
    <div id="menu">
        <div class="pure-menu">
            <a class="pure-menu-heading" href="index.html">&lt;&lt; Blog Picks</a>
            <ul class="pure-menu-list">
                <li class="pure-menu-item"><br><div class="social" style="text-align: center;"><a href="http://twitter.com/caterpillar"><img title="Twitter" alt="Twitter" src="../../Gossip/images/twitter.png"></a> <a href="http://www.facebook.com/openhome.cc"><img title="Facebook" alt="Facebook" src="../../Gossip/images/facebook.png"></a> </div><br><div id="search box"><script>(function() {var cx = 'partner-pub-9750319131714390:3926766884';var gcse = document.createElement('script');gcse.type = 'text/javascript';gcse.async = true;gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//www.google.com/cse/cse.js?cx=' + cx;var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(gcse, s);})();</script><gcse:searchbox-only></gcse:searchbox-only></div><br><div class="ad" style="text-align: center;"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 2015 新版型 160 x 600 廣告 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:160px;height:600px"
     data-ad-client="ca-pub-9750319131714390"
     data-ad-slot="3747048883"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div></li>
            </ul>
        </div>
    </div>

    <main id="main">
        <header class="header">
            <h1>Functional Programming for Java Developers, Part 5 - JDK8 Default Methods</h1>
        </header>

        <article class="content"><br><div class="ad-3" style="text-align: center;"><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- 2015 新版型回應式廣告 --><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9750319131714390" data-ad-slot="7104125683" data-ad-format="auto"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div> 
            
      
      <br>
      Let's get back to the real Java. Java provides syntax to define abstract data types and write code imperatively. It allows mutable variables and objects. Are previous articles for amusements only? What should we take from functional programming? Well...if some geniuses have written some efficient methods, such as <span

        class="courier">map</span>, <span class="courier">filter</span> and <span

        class="courier">reduce</span>, we can just program to an interface without caring details. For example, adding 1 to each list element can be as follow:<br>
      <br>
      <div class="courier" style="margin-left: 40px;">map(list(1, 2, 3, 4, 5), x -&gt; x + 1);</div>
      <br>
      Filtering a list of elements less than 3 is as follow:<br>
      <br>
      <div class="courier" style="margin-left: 40px;">filter(list(1, 2, 3, 4, 5), x -&gt; x &gt; 3);</div>
      <br>
      Summing up a list of elements can be done as follow:<br>
      <br>
      <div class="courier" style="margin-left: 40px;">reduce(list(1, 2, 3, 4, 5), (sum, x) -&gt; sum + x, 0);</div>
      <br>
      Yes, almost every Java programmer knows the principle - Program to an interface, not an implementation. Those geniuses may implement <span

        class="courier">map</span>, <span class="courier">filter</span> and <span

        class="courier">reduce</span> imperatively. They may implement short-circuit, concurrent, or lazy logic for efficiency, but you don't have to care about that. You just have to think and use those methods functionally. Am I mapping a list to another list? Am I filtering a new list from original one? Am I reducing a list to get the final result? Am I dividing my problem into sub problems? Once you are thinking functionally, you'll know why Joel Spolsky said that...<br>
      <br>
      <div style="margin-left: 40px;"><span style="font-style: italic;"><strong>...programming languages with first-class functions let you find more opportunities for abstraction.<br>
          </strong></span></div>
      <br>
      You can think functionally even you write imperative code finally. Thinking functionally may always give you a new idea or direction when writing code. That's why Simon Peyton Jones mentioned that...<br>
      <br>
      <div style="margin-left: 40px;"><strong style="font-style: italic;">...the perspectives you learn over here in the purely functional world can inform and illuminate the mainstream.</strong></div>
      <br>
      Certainly, some geniuses are willing to provide methods commonly used in functional programming languages. The question here is that, where should those methods rest? For example, where should <span

        class="courier">map</span>, <span class="courier">filter</span> and <span

        class="courier">reduce</span> rest? We can remain these methods <span

        class="courier">static</span> and rest them in the <span class="courier">Collections</span> class. This makes them like functions, such as <span

        class="courier">map</span>, <span class="courier">filter</span> and <span

        class="courier">reduce</span> in Python. Python, however, is a multi-paradigm language. Remaining <span

        class="courier">map</span>, <span class="courier">filter</span> and <span

        class="courier">reduce</span> to be functions is natural in Python. But, it's not the Java style because Java's main paradigm is object-oriented programming. Making them <span

        class="courier">static</span> methods in the <span class="courier">Collections</span> class would relegate them to a sort of second-class status. In Java, we may like a coding style as follow:<br>
      <span><br>
      </span>
      <div class="courier" style="margin-left: 40px;"><span>List&lt;String&gt; names = ...;<br>
          names.filter(s -&gt; s.length() &lt; 3)<br>
          &nbsp;&nbsp;&nbsp;&nbsp; .forEach(s -&gt; out.println(s));</span></div>
      <br>
      This is more expressive than the style like this:<br>
      <br>
      <div class="courier" style="margin-left: 40px;">forEach(filter(names, s -&gt; s.length() &lt; 3), s -&gt; out.println(s));</div>
      <br>
      Can we add a method <span class="courier">filter</span> to the <span

        class="courier">List</span> interface? If you're using JDK7 or previous versions, the answer is No! All client code implementing the <span

        class="courier">List</span> interface will break. Building a new <span

        class="courier">Collections2</span> APIs is a choice, but the <span

        class="courier">Collection</span> APIs permeate many libraries all over the world. Replacing the <span

        class="courier">Collection</span> APIs would be a major task and keep developers from using the new <span

        class="courier">Collections2</span> APIs once JDK8 is released. <br>
      <br>
      JDK8 finally takes an evolutionary strategy of evolving the <span

        class="courier">interface</span> syntax. We can add default implementations, called as <strong>default methods</strong>, to an interface. This seems like cheating because only the language creator or related organizations can take this strategy. But, it's definitely a way to do defensive API evolution with Java interfaces. <br>
      <br>
      One example of default methods is the <span class="courier">forEach</span> method defined in the <span

        class="courier">Iterable</span> interface.<br>
      <br>
      <div class="courier" style="margin-left: 40px;">package java.lang;<br>
        <br>
        import java.util.Iterator;<br>
        import java.util.Objects;<br>
        import java.util.function.Consumer;<br>
        <br>
        @FunctionalInterface<br>
        public interface Iterable&lt;T&gt; {<br>
        &nbsp;&nbsp;&nbsp; Iterator&lt;T&gt; iterator();<br>
        &nbsp;&nbsp;&nbsp; <span style="font-weight: bold;">default</span> void forEach(Consumer&lt;? super T&gt; action) {<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Objects.requireNonNull(action);<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (T t : this) {<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; action.accept(t);<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
        &nbsp;&nbsp;&nbsp; }<br>
        }</div>
      <br>
      Any implementation of <span class="courier">Iterable</span> just has to implement the <span

        class="courier">iterator</span> method, and then the client can use the <span

        class="courier">forEach</span> method directly. For example, you can write code as follow:<br>
      <br>
      <div class="courier" style="margin-left: 40px;">List&lt;String&gt; names = ...;<br>
        names.forEach(<br>
        &nbsp;&nbsp;&nbsp; name -&gt; out.println(name.toUpperCase())<br>
        );</div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
      You don't break implementations of <span class="courier">Iterable</span> because the <span

        class="courier">forEach</span> method has been implemented. Default methods make an interface like an abstract class with abstract methods. The difference is that you cannot use field members in default methods because an interface cannot define field members. As you seen above, you can use default methods to implement the Template Method pattern. For example, you may define a <span

        class="courier">Comparable</span> as follow:<br>
      <br>
      <div class="courier" style="margin-left: 40px;">public interface Comparable&lt;T&gt; {<br>
        &nbsp;&nbsp;&nbsp; int compareTo(T that);<br>
        &nbsp;&nbsp;&nbsp; <br>
        &nbsp;&nbsp;&nbsp; <strong>default</strong> boolean lessThan(T that) {<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return compareTo(that) &lt; 0;<br>
        &nbsp;&nbsp;&nbsp; }<br>
        &nbsp;&nbsp;&nbsp; <strong>default</strong> boolean lessOrEquals(T that) {<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return compareTo(that) &lt;= 0;<br>
        &nbsp;&nbsp;&nbsp; }<br>
        &nbsp;&nbsp;&nbsp; <strong>default</strong> boolean greaterThan(T that) {<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return compareTo(that) &gt; 0;<br>
        &nbsp;&nbsp;&nbsp; }<br>
        &nbsp;&nbsp;&nbsp; ...<br>
        }</div>
      <br>
      A <span class="courier">Ball</span> class implementing the <span

        class="courier">Comparable</span> interface just has to implement the <span

        class="courier">compareTo</span> method.<br>
      <br>
      <div class="courier" style="margin-left: 40px;"><span>public class Ball implements Comparable&lt;Ball&gt; {<br>
          &nbsp;&nbsp;&nbsp; private int radius;<br>
          &nbsp;&nbsp;&nbsp; ...<br>
          &nbsp;&nbsp;&nbsp; public int compareTo(Ball that) {<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return this.radius - that.radius;<br>
          &nbsp;&nbsp;&nbsp; }<br>
          }</span></div>
      <br>
      Then, every <span class="courier">Ball</span> instance owns those default methods defined in the <span

        class="courier">Comparable</span> interface. Because a class can implement more than one interface, default methods make interface something like the <span

        class="courier">Trait</span> in Scala, or the <span class="courier">Module</span> in Ruby. You can define shared implementations in some interfaces. Once a class needs some shared operations, they can implement necessary interfaces, implement abstract methods, and mixin shared operations. <br>
      <br>
      Of course, there're several details about default methods. You can look more in the article <a

        href="http://cr.openjdk.java.net/%7Ebriangoetz/lambda/lambda-state-4.html">State of the Lambda v4</a>. Let's back to our previous example. We may like a coding style as follow:<br>
      <br>
      <div class="courier" style="margin-left: 40px;">List&lt;String&gt; names = ...;<br>
        names.filter(s -&gt; s.length() &lt; 3)<br>
        &nbsp;&nbsp;&nbsp;&nbsp; .forEach(s -&gt; out.println(s));</div>
      <br>
      But in JDK8, we have to write code as follow:<br>
      <br>
      <div class="courier" style="margin-left: 40px;">List&lt;String&gt; names = ...;<br>
        names.<span style="font-weight: bold;">stream()</span><br>
        &nbsp;&nbsp;&nbsp;&nbsp; .filter(s -&gt; s.length() &lt; 3)<br>
        &nbsp;&nbsp;&nbsp;&nbsp; .forEach(s -&gt; out.println(s));</div>
      &nbsp;&nbsp;&nbsp;&nbsp; <br>
      Why do we need that stream method? That's what we will look in the next article.<br>
      <br>
<div class="recommend" style="text-align: center;"><hr><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- 自動大小回應相符內容 --><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9750319131714390" data-ad-slot="4953478487" data-ad-format="autorelaxed"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div>
        </article></main></div></body>
<script src="../../Gossip/js/ui.js"></script>
</html>
<div class="analytics"><script async src="https://www.googletagmanager.com/gtag/js?id=G-QVQQYFSC8J"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-QVQQYFSC8J');</script></div>
